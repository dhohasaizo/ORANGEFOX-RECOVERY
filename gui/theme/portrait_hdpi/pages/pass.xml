<?xml version="1.0"?>
<recovery>
	<pages>
		<page name="password_enter">
			<template name="body_key"/>

			<template name="ab_main"/>

			<template name="statusbarinfo"/>

			<text style="text_ab_title">
				<placement x="%col1_x%" y="%ab_bc_y%"/>
				<text>{@enter_password_cptn}</text>
			</text>

			<button>
				<condition var1="tw_reboot_poweroff" var2="1"/>
				<placement x="%ab_btn1_x%" y="%ab_y%"/>
				<image resource="actionbar_btn" highlightresource="actionbar_btn_hl"/>
				<action function="set">tw_back=password_enter</action>
				<action function="set">tw_action_param=poweroff</action>
				<action function="set">tw_reboot_param=poweroff</action>
				<action function="page">rebootcheck</action>
			</button>
			
			<button>
				<condition var1="tw_reboot_poweroff" op="!=" var2="1"/>
				<condition var1="tw_reboot_system" var2="1"/>
				<placement x="%ab_btn1_x%" y="%ab_y%"/>
				<image resource="actionbar_btn" highlightresource="actionbar_btn_hl"/>
				<action function="set">tw_back=password_enter</action>
				<action function="page">reboot_system_routine</action>
			</button>

			<image>
				<placement x="%ab_btn1_x%" y="%ab_y%"/>
				<image resource="actionbar_power_off"/>
			</image>

			<text style="caption_hl">
				<placement x="%col1_x%" y="%row1_1_y%"/>
				<text>{@decrypt_data_enter_pass}</text>
			</text>

			<input>
				<condition var1="pass_govno" op="!=" var2="2"/>
				<placement x="%col1_x%" y="%input_backup_y%" w="%input_width%" h="%input_height%"/>
				<text>%pass_enter_mask%</text>
				<data name="pass_enter" mask="*" maskvariable="pass_enter_mask"/>
				<restrict minlen="0" maxlen="64" />
				<action function="page">password_check</action>
			</input>

			<fill color="%accent%">
				<condition var1="pass_govno" var2="0"/>
				<placement x="%col1_x%" y="%row1_3_y%" w="%content_w%" h="%input_line_height%" placement="1"/>
			</fill>

			<fill color="%text_fail%">
				<condition var1="pass_govno" var2="1"/>
				<placement x="%col1_x%" y="%row1_3_y%" w="%content_w%" h="%input_line_height%" placement="1"/>
			</fill>

			<text style="text_input_fail">
				<condition var1="pass_govno" var2="1"/>
				<placement x="%col1_x%" y="%row1_3_y%"/>
				<text>{@pass_not_match}</text>
			</text>

			<action>
				<touch key="home"/>
				<action function="page">password_enter</action>
			</action>

			<action>
				<touch key="back"/>
				<action function="page">password_enter</action>
			</action>
		</page>

		<page name="password_check">
			<action>
				<condition var1="pass_enter" op="=" var2="%pass_true%"/>
				<condition var1="tw_has_mtp" var2="1"/>
				<action function="startmtp"/>
			</action>
			
			<action>
				<condition var1="pass_enter" op="=" var2="%pass_true%"/>
				<actions>
					<action function="set">pass_open=1</action>
					<action function="page">main</action>
				</actions>
			</action>
			
			<action>
				<condition var1="pass_enter" op="!=" var2="%pass_true%"/>
				<actions>
					<action function="set">pass_govno=1</action>
					<action function="page">password_enter</action>
				</actions>
			</action>
		</page>

		<page name="dialog_setpass1">
			<template name="dialog_body_key"/>

			<button>
				<placement x="%bg_storage_x%" y="%bg_encrypt_y%"/>
				<image resource="dialog_bg"/>
			</button>

			<text style="text_dlg_title">
				<placement x="%bg_storage_hdr_x%" y="%bg_encrypt_hdr_y%"/>
				<text>{@enter_password_cptn}</text>
			</text>

			<text style="caption_hl">
				<placement x="%bg_storage_hdr_x%" y="%row2_2a_y%"/>
				<text>{@set_password}</text>
			</text>

			<input>
				<placement x="%bg_storage_hdr_x%" y="%input_encr_y%" w="%input_encr_width%" h="%input_height%"/>
				<text>%pass_new_1_mask%</text>
				<data name="pass_new_1" mask="*" maskvariable="pass_new_1_mask"/>
				<restrict minlen="0" maxlen="64"/>
				<actions>
					<action function="overlay"/>
					<action function="overlay">dialog_setpass2</action>
				</actions>
			</input>

			<fill color="%accent%">
				<condition var1="pass_notm" op="!=" var2="1"/>
				<placement x="%bg_storage_hdr_x%" y="%row3_1a_y%" w="%input_encr_width%" h="%input_line_height%" placement="1"/>
			</fill>

			<fill color="%text_fail%">
				<condition var1="pass_notm" var2="1"/>
				<placement x="%bg_storage_hdr_x%" y="%row3_1a_y%" w="%input_encr_width%" h="%input_line_height%" placement="1"/>
			</fill>

			<text style="text_input_fail">
				<condition var1="pass_notm" var2="1"/>
				<placement x="%bg_storage_hdr_x%" y="%row3_1a_y%"/>
				<text>{@pass_not_match}</text>
			</text>

			<button style="btn_dlg">
				<placement x="%db_right_x%" y="%db_encrypt_y%"/>
				<text>{@cancel_btn}</text>
				<action function="key">back</action>
			</button>

			<action>
				<touch key="home"/>
				<action function="key">back</action>
				<action function="page">main</action>
			</action>

			<action>
				<touch key="back"/>
				<action function="set">pass_new_1=</action>
				<action function="set">pass_new_2=</action>
				<action function="set">pass_notm=0</action>
				<action function="overlay"/>
			</action>
		</page>

		<page name="dialog_setpass2">
			<template name="dialog_body_key"/>

			<button>
				<placement x="%bg_storage_x%" y="%bg_encrypt_y%"/>
				<image resource="dialog_bg"/>
			</button>

			<text style="text_dlg_title">
				<placement x="%bg_storage_hdr_x%" y="%bg_encrypt_hdr_y%"/>
				<text>{@enter_password_cptn}</text>
			</text>

			<text style="caption_hl">
				<placement x="%bg_storage_hdr_x%" y="%row2_2a_y%"/>
				<text>{@verifying_pas}</text>
			</text>

			<input>
				<placement x="%bg_storage_hdr_x%" y="%input_encr_y%" w="%input_encr_width%" h="%input_height%"/>
				<text>%pass_new_2_mask%</text>
				<data name="pass_new_2" mask="*" maskvariable="pass_new_2_mask"/>
				<restrict minlen="0" maxlen="64"/>
				<actions>
					<action function="overlay"/>
					<action function="page">pass_check</action>
				</actions>
			</input>

			<fill color="%accent%">
				<placement x="%bg_storage_hdr_x%" y="%row3_1a_y%" w="%input_encr_width%" h="%input_line_height%" placement="1"/>
			</fill>

			<button style="btn_dlg">
				<placement x="%db_right_x%" y="%db_encrypt_y%"/>
				<text>{@cancel_btn}</text>
				<action function="key">back</action>
			</button>

			<action>
				<touch key="home"/>
				<action function="key">back</action>
				<action function="page">main</action>
			</action>

			<action>
				<touch key="back"/>
				<action function="set">pass_new_1=</action>
				<action function="set">pass_new_2=</action>
				<action function="set">pass_notm=0</action>
				<action function="overlay"/>
			</action>
		</page>

		<page name="pass_check">
			<action>
				<condition var1="pass_new_2" op="=" var2="%pass_new_1%"/>
				<actions>
					<action function="set">use_pass=1</action>
					<action function="set">pass_notm=0</action>
					<action function="set">pass_true=%pass_new_1%</action>
					<action function="page">ext_general</action>
				</actions>
			</action>

			<action>
				<condition var1="pass_new_2" op="!=" var2="%pass_new_1%"/>
				<actions>
					<action function="set">pass_notm=1</action>
					<action function="page">ext_general</action>
					<action function="overlay">dialog_setpass1</action>
				</actions>
			</action>
		</page>
	</pages>
</recovery>